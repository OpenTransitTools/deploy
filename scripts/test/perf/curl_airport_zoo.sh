m=${1:-"https://ws-st.trimet.org"}
p=${2:-"/rtp/gtfs/v1"}
#echo "$m$p"

# trip date & time: 2024-09-27 10:53
d=`date +"%Y-%m-%d"`
t=`date +"%H:%M"`
# echo $d $t; exit

curl -m 30 "$m$p" \
  -H 'Accept: */*' \
  -H 'Accept-Language: en-US,en;q=0.9' \
  -H 'Connection: keep-alive' \
  -H 'Content-Type: application/json' \
  -H 'Origin: https://rtp.trimet.org' \
  -H 'Referer: https://rtp.trimet.org/' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Site: same-site' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36' \
  -H 'sec-ch-ua: "Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "macOS"' \
  --data-raw $'{"batchId":"ki083zr7u","query":"query Plan($arriveBy: Boolean, $banned: InputBanned, $bikeReluctance: Float, $carReluctance: Float, $date: String, $fromPlace: String\u0021, $modes: [TransportMode], $numItineraries: Int, $preferred: InputPreferred, $time: String, $toPlace: String\u0021, $unpreferred: InputUnpreferred, $walkReluctance: Float, $walkSpeed: Float, $wheelchair: Boolean) {\\n  plan(\\n    arriveBy: $arriveBy\\n    banned: $banned\\n    bikeReluctance: $bikeReluctance\\n    carReluctance: $carReluctance\\n    date: $date\\n    fromPlace: $fromPlace\\n    locale: \\"en\\"\\n    numItineraries: $numItineraries\\n    preferred: $preferred\\n    time: $time\\n    toPlace: $toPlace\\n    transportModes: $modes\\n    unpreferred: $unpreferred\\n    walkReluctance: $walkReluctance\\n    walkSpeed: $walkSpeed\\n    wheelchair: $wheelchair\\n  ) {\\n    itineraries {\\n      accessibilityScore\\n      duration\\n      endTime\\n      legs {\\n        accessibilityScore\\n        agency {\\n          alerts {\\n            alertDescriptionText\\n            alertHeaderText\\n            alertUrl\\n            effectiveStartDate\\n            id\\n          }\\n          gtfsId\\n          id: gtfsId\\n          name\\n          timezone\\n          url\\n        }\\n        alerts {\\n          alertDescriptionText\\n          alertHeaderText\\n          alertUrl\\n          effectiveStartDate\\n          id\\n        }\\n        arrivalDelay\\n        departureDelay\\n        distance\\n        dropOffBookingInfo {\\n          contactInfo {\\n            bookingUrl\\n            infoUrl\\n            phoneNumber\\n          }\\n          earliestBookingTime {\\n            daysPrior\\n            time\\n          }\\n          latestBookingTime {\\n            daysPrior\\n            time\\n          }\\n          message\\n        }\\n        dropoffType\\n        duration\\n        endTime\\n        fareProducts {\\n          id\\n          product {\\n            __typename\\n            id\\n            medium {\\n              id\\n              name\\n            }\\n            name\\n            riderCategory {\\n              id\\n              name\\n            }\\n            ... on DefaultFareProduct {\\n              price {\\n                amount\\n                currency {\\n                  code\\n                  digits\\n                }\\n              }\\n            }\\n          }\\n        }\\n        from {\\n          lat\\n          lon\\n          name\\n          rentalVehicle {\\n            id\\n            network\\n          }\\n          stop {\\n            alerts {\\n              alertDescriptionText\\n              alertHeaderText\\n              alertUrl\\n              effectiveStartDate\\n              id\\n            }\\n            code\\n            gtfsId\\n            id\\n            lat\\n            lon\\n          }\\n          vertexType\\n        }\\n        headsign\\n        interlineWithPreviousLeg\\n        intermediateStops {\\n          lat\\n          locationType\\n          lon\\n          name\\n          stopCode: code\\n          stopId: id\\n        }\\n        legGeometry {\\n          length\\n          points\\n        }\\n        mode\\n        pickupBookingInfo {\\n          contactInfo {\\n            bookingUrl\\n            infoUrl\\n            phoneNumber\\n          }\\n          earliestBookingTime {\\n            daysPrior\\n            time\\n          }\\n          latestBookingTime {\\n            daysPrior\\n            time\\n          }\\n          message\\n        }\\n        pickupType\\n        realTime\\n        realtimeState\\n        rentedBike\\n        rideHailingEstimate {\\n          arrival\\n          maxPrice {\\n            amount\\n            currency {\\n              code\\n            }\\n          }\\n          minPrice {\\n            amount\\n            currency {\\n              code\\n            }\\n          }\\n          provider {\\n            id\\n          }\\n        }\\n        route {\\n          alerts {\\n            alertDescriptionText\\n            alertHeaderText\\n            alertUrl\\n            effectiveStartDate\\n            id\\n          }\\n          color\\n          gtfsId\\n          id: gtfsId\\n          longName\\n          shortName\\n          textColor\\n          type\\n        }\\n        startTime\\n        steps {\\n          absoluteDirection\\n          alerts {\\n            alertDescriptionText\\n            alertHeaderText\\n            alertUrl\\n            effectiveStartDate\\n            id\\n          }\\n          area\\n          distance\\n          elevationProfile {\\n            distance\\n            elevation\\n          }\\n          lat\\n          lon\\n          relativeDirection\\n          stayOn\\n          streetName\\n        }\\n        to {\\n          lat\\n          lon\\n          name\\n          rentalVehicle {\\n            id\\n            network\\n          }\\n          stop {\\n            alerts {\\n              alertDescriptionText\\n              alertHeaderText\\n              alertUrl\\n              effectiveStartDate\\n              id\\n            }\\n            code\\n            gtfsId\\n            id\\n            lat\\n            lon\\n          }\\n          vertexType\\n        }\\n        transitLeg\\n        trip {\\n          arrivalStoptime {\\n            stop {\\n              gtfsId\\n              id\\n            }\\n            stopPosition\\n          }\\n          departureStoptime {\\n            stop {\\n              gtfsId\\n              id\\n            }\\n            stopPosition\\n          }\\n          gtfsId\\n          id\\n        }\\n      }\\n      startTime\\n      transfers: numberOfTransfers\\n      waitingTime\\n      walkTime\\n    }\\n    routingErrors {\\n      code\\n      description\\n      inputField\\n    }\\n  }\\n}","variables":{"arriveBy":false,"banned":{},"date":"${d}","fromPlace":"PDX, Portland::45.589178,-122.593464","modes":[{"mode":"BICYCLE"}],"numItineraries":3,"time":"${t}","toPlace":"Oregon Zoo, Portland::45.510074,-122.715966","walkReluctance":5}}' \
  --compressed
